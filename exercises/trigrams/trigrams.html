

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Trigrams – Simple Text Manipulation &mdash; Programming in Python 8.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=bb3927b2"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="10. Modules and Packages" href="../../topics/10-modules_packages/index.html" />
    <link rel="prev" title="Mailroom With Files" href="../mailroom/mailroom_with_files.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #4b2e83" >

          
          
          <a href="../../index.html">
            
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Topics in the Program</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../topics/01-setting_up/index.html">1. Setting up your Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/02-basic_python/index.html">2. Basic Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/03-recursion_booleans/index.html">3. Booleans and Recursion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/04-sequences_iteration/index.html">4. Sequences and Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/05-text_handling/index.html">5. Basic Text Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/06-exceptions/index.html">6. Exception Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/07-unit_testing/index.html">7. Unit Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/08-dicts_sets/index.html">8. Dictionaries and Sets</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../topics/09-files/index.html">9. File Handling</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../modules/Files.html">File Reading and Writing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../file_processing/file_lab.html">File Exercise</a></li>
<li class="toctree-l2"><a class="reference internal" href="../file_processing/file_processing.html">File Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mailroom/mailroom_with_files.html">Mailroom With Files</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Trigrams – Simple Text Manipulation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/10-modules_packages/index.html">10. Modules and Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/11-argument_passing/index.html">11. Advanced Argument Passing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/12-comprehensions/index.html">12. Comprehensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/13-intro_oo/index.html">13. Intro to Object Oriented Programing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/14-magic_methods/index.html">14. Properties and Magic Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/15-subclassing/index.html">15. Subclassing and Inheritance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/16-multiple_inheritance/index.html">16. Multiple Inheritance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/17-functional_programming/index.html">17. Introduction to Functional Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/18-advanced_testing/index.html">18. Advanced Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/99-extras/index.html">19. Extra Topics</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #4b2e83" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Programming in Python</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../topics/09-files/index.html"><span class="section-number">9. </span>File Handling</a></li>
      <li class="breadcrumb-item active">Trigrams – Simple Text Manipulation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/exercises/trigrams/trigrams.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="../mailroom/mailroom_with_files.html" class="btn btn-neutral float-left" title="Mailroom With Files" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../topics/10-modules_packages/index.html" class="btn btn-neutral float-right" title="10. Modules and Packages" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="trigrams-simple-text-manipulation">
<span id="exercise-trigrams"></span><h1>Trigrams – Simple Text Manipulation<a class="headerlink" href="#trigrams-simple-text-manipulation" title="Link to this heading"></a></h1>
<p class="rubric">Kata Fourteen: Tom Swift Under the Milk Wood</p>
<p>Adapted from Dave Thomas’s work:</p>
<p><a class="reference external" href="http://codekata.com/kata/kata14-tom-swift-under-the-milkwood/">http://codekata.com/kata/kata14-tom-swift-under-the-milkwood/</a></p>
<section id="trigrams">
<h2>Trigrams<a class="headerlink" href="#trigrams" title="Link to this heading"></a></h2>
<p>Trigrams can be used to mutate text into new, surreal, forms. But what
heuristics do we apply to get a reasonable result?</p>
<section id="the-problem">
<h3>The Problem<a class="headerlink" href="#the-problem" title="Link to this heading"></a></h3>
<p>As a boy, one of my treats was go to the shops on a Saturday and spend part
of my allowance on books; for a nine-year old, I had quite a collection of books from the
Tom Swift and Hardy Boys series. Wouldn’t it be great to be able to create
more and more of these classic books, to be able to generate a new Tom
Swift adventure on demand?</p>
<p>OK, perhaps not. But that won’t stop us trying. I coded up a quick
program to generate some swashbuckling scientific adventure on demand. It
came up with:</p>
<blockquote>
<div><p>… it was in the wind that was what he thought was his companion. I
think would be a good one and accordingly the ship their situation
improved. Slowly so slowly that it beat the band! You’d think no one
was a low voice. “Don’t take any of the elements and the
inventors of the little Frenchman in the enclosed car or cabin completely
fitted up in front of the gas in the house and wringing her hands.
“I’m sure they’ll fall!”</p>
<p>She looked up at them. He dug a mass of black vapor which it had
refused to accept any. As for Mr. Swift as if it goes too high I’ll
warn you and you can and swallow frequently. That will make the airship was
shooting upward again and just before the raid wouldn’t have been
instrumental in capturing the scoundrels right out of jail.”</p>
</div></blockquote>
<p>Stylistically, it’s Victor Appleton (pseudonymous author of the Tom Swift series) meets Dylan Thomas (Welsh poet). Technically,
it’s all done with trigrams.</p>
<p>Trigram analysis is very simple. Look at each set of three adjacent words
in a document. Use the first two words of the set as a key, and remember
the fact that the third word followed that key. Once you’ve finished,
you know the list of individual words that can follow each two word
sequence in the document. For example, given the input:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">I</span> <span class="n">wish</span> <span class="n">I</span> <span class="n">may</span> <span class="n">I</span> <span class="n">wish</span> <span class="n">I</span> <span class="n">might</span>
</pre></div>
</div>
<p>You might generate:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;I wish&quot;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">]</span>
<span class="s2">&quot;wish I&quot;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s2">&quot;may&quot;</span><span class="p">,</span> <span class="s2">&quot;might&quot;</span><span class="p">]</span>
<span class="s2">&quot;may I&quot;</span>  <span class="o">=&gt;</span> <span class="p">[</span><span class="s2">&quot;wish&quot;</span><span class="p">]</span>
<span class="s2">&quot;I may&quot;</span>  <span class="o">=&gt;</span> <span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>This says that the words “I wish” are twice followed by the word
“I”, the words “wish I” are followed once by “may” and once by “might”
and so on.</p>
<p>To generate new text from this analysis, choose an arbitrary word pair as a
starting point. Use this pair of words to look up a random next word (using the table
above) and append this new word to the text so far. This now gives you three words with a
new word pair (second and third words) at the end of the three-word text. Look up a potential next word
based on this pair. This generates another pair to add to the list, and so on. In the previous example,
we could start with “I may”. The only possible next word is
“I”, so now we have:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">I</span> <span class="n">may</span> <span class="n">I</span>
</pre></div>
</div>
<p>The last two words are “may I,” so the next word is
“wish”. We then look up “I wish,” and find our choice
is constrained to another “I”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">I</span> <span class="n">may</span> <span class="n">I</span> <span class="n">wish</span> <span class="n">I</span>
</pre></div>
</div>
<p>Now we look up “wish I,” and find we have a choice. Let’s
choose “may”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">I</span> <span class="n">may</span> <span class="n">I</span> <span class="n">wish</span> <span class="n">I</span> <span class="n">may</span>
</pre></div>
</div>
<p>Now we’re back where we started from, with “I may.”
Following the same sequence, but choosing “might” this time, we
get:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">I</span> <span class="n">may</span> <span class="n">I</span> <span class="n">wish</span> <span class="n">I</span> <span class="n">may</span> <span class="n">I</span> <span class="n">wish</span> <span class="n">I</span> <span class="n">might</span>
</pre></div>
</div>
<p>At this point we stop, as no sequence starts “I might.”</p>
<p>Given a short input text, the algorithm isn’t too interesting. Feed
it a book, however, and you give it more options, so the resulting output
can be surprising.</p>
<p>For this exercise, try implementing a trigram algorithm that generates a couple
of hundred words of text using a book-sized file as input.
<a class="reference external" href="http://www.gutenberg.org/">Project Gutenberg</a> is a good source of online
books (<em>Tom Swift and His Airship</em> is <a class="reference external" href="http://sailor.gutenberg.org/etext02/03tom10.txt">here</a>.)</p>
<p>Be warned that these files have DOS line endings (carriage return followed by
newline).</p>
<p>Here is a copy of short-story collection <em>The Adventures of Sherlock Holmes</em>:</p>
<p><a class="reference download internal" download="" href="../../_downloads/9f634eee56ccdd2ea8c081c80013fb12/sherlock.txt"><code class="xref download docutils literal notranslate"><span class="pre">sherlock.txt</span></code></a>.</p>
<p>And a shorter copy for testing (a paragraph from one of the stories, “A Scandal in Bohemia”):</p>
<p><a class="reference download internal" download="" href="../../_downloads/348f5dbfabfa7d9ee9f70955645ff009/sherlock_small.txt"><code class="xref download docutils literal notranslate"><span class="pre">sherlock_small.txt</span></code></a>.</p>
</section>
<section id="objectives">
<h3>Objectives<a class="headerlink" href="#objectives" title="Link to this heading"></a></h3>
<p>Katas are about trying something many times. In this one, what
we’re experimenting with is not just the code, but the heuristics of
processing the text. What do we do with punctuation? Paragraphs? Do we have
to implement backtracking if we chose a next word that turns out to be a
dead end?</p>
<p>I’ll fire the signal and the fun will commence…</p>
</section>
</section>
<section id="developing-your-solution">
<h2>Developing Your Solution<a class="headerlink" href="#developing-your-solution" title="Link to this heading"></a></h2>
<p>This assignment has two parts: the key one is the trigrams exercise itself, but you also need to do some text processing to get a full book in shape for the building the trigrams.</p>
<p>I suggest you write the trigrams part first; it’s more interesting :-)</p>
<section id="test-driven-development">
<h3>Test Driven Development<a class="headerlink" href="#test-driven-development" title="Link to this heading"></a></h3>
<p>You’ve recently learned about unit testing and Test Driven Development (TDD). Let’s put that to work on this exercise. Remember that the key to TDD is that you first decide on what you need a piece of your code to do, then you write a test to check that it does that, and only then do you write the actual code itself.</p>
<p>Because you’re new to this, we’re going to give you some tests to get you started. You’ll find them in: <a class="reference download internal" download="" href="../../_downloads/635b3b2d18f105d5824bbb9721a88320/test_trigrams.py"><code class="xref download docutils literal notranslate"><span class="pre">test_trigrams.py</span></code></a>, which should be with this assignment.</p>
<section id="running-the-tests">
<h4>Running the Tests<a class="headerlink" href="#running-the-tests" title="Link to this heading"></a></h4>
<p>To run the tests, use the <code class="docutils literal notranslate"><span class="pre">pytest</span></code> test runner: set your working directory the dir with the test file, and run the <code class="docutils literal notranslate"><span class="pre">pytest</span></code> command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nv">pytest</span>
<span class="o">=======================</span><span class="w"> </span><span class="nb">test</span><span class="w"> </span>session<span class="w"> </span><span class="nv">starts</span><span class="w"> </span><span class="o">=======================</span>
platform<span class="w"> </span>darwin<span class="w"> </span>--<span class="w"> </span>Python<span class="w"> </span><span class="m">3</span>.8.2,<span class="w"> </span>pytest-5.4.3,<span class="w"> </span>py-1.8.2,<span class="w"> </span>pluggy-0.13.1
rootdir:<span class="w"> </span>/Users/chris.barker/Personal/UWPCE/Python210CourseMaterials/source/exercises/trigrams
collected<span class="w"> </span><span class="m">0</span><span class="w"> </span>items<span class="w"> </span>/<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="nv">error</span>

<span class="o">=============================</span><span class="w"> </span><span class="nv">ERRORS</span><span class="w"> </span><span class="o">==============================</span>
________________<span class="w"> </span>ERROR<span class="w"> </span>collecting<span class="w"> </span>test_trigrams.py<span class="w"> </span>________________
ImportError<span class="w"> </span><span class="k">while</span><span class="w"> </span>importing<span class="w"> </span><span class="nb">test</span><span class="w"> </span>module<span class="w"> </span><span class="s1">&#39;/Users/chris.barker/Personal/UWPCE/Python210CourseMaterials/source/exercises/trigrams/test_trigrams.py&#39;</span>.
Hint:<span class="w"> </span>make<span class="w"> </span>sure<span class="w"> </span>your<span class="w"> </span><span class="nb">test</span><span class="w"> </span>modules/packages<span class="w"> </span>have<span class="w"> </span>valid<span class="w"> </span>Python<span class="w"> </span>names.
Traceback:
test_trigrams.py:17:<span class="w"> </span><span class="k">in</span><span class="w"> </span>&lt;module&gt;
<span class="w">    </span>import<span class="w"> </span>trigrams
E<span class="w">   </span>ModuleNotFoundError:<span class="w"> </span>No<span class="w"> </span>module<span class="w"> </span>named<span class="w"> </span><span class="s1">&#39;trigrams&#39;</span>
<span class="o">=====================</span><span class="w"> </span>short<span class="w"> </span><span class="nb">test</span><span class="w"> </span>summary<span class="w"> </span><span class="nv">info</span><span class="w"> </span><span class="o">=====================</span>
ERROR<span class="w"> </span>test_trigrams.py
!!!!!!!!!!!!!<span class="w"> </span>Interrupted:<span class="w"> </span><span class="m">1</span><span class="w"> </span>error<span class="w"> </span>during<span class="w"> </span>collection<span class="w"> </span>!!!!!!!!!!!!!!
<span class="o">========================</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>error<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span>.13s<span class="w"> </span><span class="o">=========================</span>
</pre></div>
</div>
<p>You should have gotten something like that error: it is indicating that the “trigrams” module does not exist – which makes sense, as you haven’t written it yet. So the first step is to create your code file: name it <code class="docutils literal notranslate"><span class="pre">trigrams.py</span></code> and put it in the same directory as the <code class="docutils literal notranslate"><span class="pre">test_trigrams.py</span></code> file. It can be empty for now. Now try running pytest again, and it should get farther: you’ll have a lot of test failures, but the test should actually run. You should get something like:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>test_trigrams.py:130:<span class="w"> </span><span class="nv">AttributeError</span>
<span class="o">======================</span><span class="w"> </span>short<span class="w"> </span><span class="nb">test</span><span class="w"> </span>summary<span class="w"> </span><span class="nv">info</span><span class="w"> </span><span class="o">=======================</span>
FAILED<span class="w"> </span>test_trigrams.py::test_trigrams_pairs<span class="w"> </span>-<span class="w"> </span>AttributeError:<span class="w"> </span>modu...
FAILED<span class="w"> </span>test_trigrams.py::test_trigrams_following_words<span class="w"> </span>-<span class="w"> </span>AttributeE...
FAILED<span class="w"> </span>test_trigrams.py::test_pick_random_pair<span class="w"> </span>-<span class="w"> </span>AttributeError:<span class="w"> </span>mo...
FAILED<span class="w"> </span>test_trigrams.py::test_get_last_pair<span class="w"> </span>-<span class="w"> </span>AttributeError:<span class="w"> </span>modul...
FAILED<span class="w"> </span>test_trigrams.py::test_get_random_follower<span class="w"> </span>-<span class="w"> </span>AttributeError:...
FAILED<span class="w"> </span>test_trigrams.py::test_get_random_follower_not_there<span class="w"> </span>-<span class="w"> </span>Attri...
FAILED<span class="w"> </span>test_trigrams.py::test_make_sentence<span class="w"> </span>-<span class="w"> </span>AttributeError:<span class="w"> </span>modul...
<span class="o">=========================</span><span class="w"> </span><span class="m">7</span><span class="w"> </span>failed<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span>.18s<span class="w"> </span><span class="o">==========================</span>
</pre></div>
</div>
<p>You get a bunch of AttributeErrors, as you haven’t defined anything in your <code class="docutils literal notranslate"><span class="pre">trigrams.py</span></code> file. So now it’s time to actually work on the code!</p>
</section>
</section>
<section id="id1">
<h3>trigrams<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<p>Key to the trigrams problem is the selection of the data structure to use to hold the “trigrams” themselves. What do we need here?</p>
<section id="the-text">
<h4>The text<a class="headerlink" href="#the-text" title="Link to this heading"></a></h4>
<p>First, you’ll want a bit of text to try your code out on. Why not try the example here:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">I</span> <span class="n">wish</span> <span class="n">I</span> <span class="n">may</span> <span class="n">I</span> <span class="n">wish</span> <span class="n">I</span> <span class="n">might</span>
</pre></div>
</div>
<p>You need that in a python data structure somehow, so how about:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">words</span> <span class="o">=</span> <span class="s2">&quot;I wish I may I wish I might&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</pre></div>
</div>
<p>This produces an (ordered) list of words:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;wish&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;may&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;wish&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;might&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Now you’ve got some words to play with. Once you think you’ve got it working, try a bit longer piece of text. But this will do for now, and it’s small and simple enough that you can immediately see if your code is working.</p>
<p>You will find that example in the test file, so we can write tests against it:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">IWISH</span> <span class="o">=</span> <span class="s2">&quot;I wish I may I wish I might&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="the-trigrams-structure">
<h3>The trigrams structure<a class="headerlink" href="#the-trigrams-structure" title="Link to this heading"></a></h3>
<p>Now we need to think a bit about what we want the trigrams structure to be.</p>
<p>From above, we know that we need to build up something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;I wish&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span>
<span class="s2">&quot;wish I&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;may&quot;</span><span class="p">,</span> <span class="s2">&quot;might&quot;</span>
<span class="s2">&quot;may I&quot;</span>  <span class="o">=&gt;</span> <span class="s2">&quot;wish&quot;</span>
<span class="s2">&quot;I may&quot;</span>  <span class="o">=&gt;</span> <span class="s2">&quot;I&quot;</span>
</pre></div>
</div>
<p>Hmmm, in a way, that’s almost pseudo code. You have a bunch of word pairs, and for each word pair, there are one or more words that follow it.</p>
<p>Those following words look a lot like they could be in a list, yes? Perfect, the list structure keeps order, and you can keep adding (appending) new words to it.</p>
<p>Each of those lists of words needs to be mapped to a particular pair. Each pair is unique; it only shows up once (when that same pair is encountered again in the text, you add the follower to the list of following words).</p>
<p>That sounds a lot like a dictionary. The keys (word pairs) are unique, and map to a list of following words. (Note that, technically, in python the dictionary is only one implementation of a
<a class="reference external" href="https://docs.python.org/3/glossary.html#term-mapping">Mapping</a>.)</p>
<p>Now you have a choice of data structures for the word pairs, or keys in the dict: a string or a tuple.</p>
<p><strong>String</strong>: The keys are a pair of words and can be represented as a string of two words with a space like so:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">trigrams</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;I wish&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">],</span>
            <span class="s2">&quot;wish I&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;may&quot;</span><span class="p">,</span> <span class="s2">&quot;might&quot;</span><span class="p">],</span>
            <span class="s2">&quot;may I&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;wish&quot;</span><span class="p">],</span>
            <span class="s2">&quot;I may&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">],</span>
            <span class="p">}</span>
</pre></div>
</div>
<p><strong>Tuple</strong>: But strings are not the only type that you can use as keys in a dictionary; you can use any <em>immutable</em> type. Recall that tuples are immutable (they can’t be changed once they have been created). Since each pair of words is, well, a pair, it makes sense to store each pair in a tuple, keeping the individual words separate:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">trigrams</span> <span class="o">=</span> <span class="p">{(</span><span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;wish&quot;</span><span class="p">):</span> <span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">],</span>
            <span class="p">(</span><span class="s2">&quot;wish&quot;</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">):</span> <span class="p">[</span><span class="s2">&quot;may&quot;</span><span class="p">,</span> <span class="s2">&quot;might&quot;</span><span class="p">],</span>
            <span class="p">(</span><span class="s2">&quot;may&quot;</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">):</span> <span class="p">[</span><span class="s2">&quot;wish&quot;</span><span class="p">],</span>
            <span class="p">(</span><span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;may&quot;</span><span class="p">):</span> <span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">],</span>
            <span class="p">}</span>
</pre></div>
</div>
<p>I like the version that uses tuples better, but either one will work. The test code is designed to check for word pairs in tuples. If you want to write your code using space separated strings, you can modify the tests.</p>
<section id="building-the-trigrams-dict">
<h4>Building the Trigrams dict<a class="headerlink" href="#building-the-trigrams-dict" title="Link to this heading"></a></h4>
<p>So you’ve got a list of words, and you need to build up a dict like one of the above.</p>
<p>It’s time to create a python file and start writing some code!</p>
<p>Put this in your <code class="docutils literal notranslate"><span class="pre">trigrams.py</span></code> file</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>

<span class="k">def</span><span class="w"> </span><span class="nf">build_trigram</span><span class="p">(</span><span class="n">words</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    build up the trigrams dict from the list of words</span>

<span class="sd">    :param words: a list of individual words in order</span>

<span class="sd">    :returns: a dict with:</span>
<span class="sd">         keys: word pairs in tuples</span>
<span class="sd">         values: list of the words that follow the pain in the key</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">trigrams</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># build up the dict here!</span>

    <span class="k">return</span> <span class="n">trigrams</span>
</pre></div>
</div>
<p>So how do you actually build up that dict? That’s kind of the point of the exercise, so I won’t tell you that … but here are some hints:</p>
<p><strong>Looping through the words</strong></p>
<p>Obviously you need to loop through all the words, so a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop makes sense. However, this is a bit tricky. Usually in Python you loop through all the items in a list, and don’t worry about the indexes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">a_list</span><span class="p">:</span>
   <span class="o">...</span>
</pre></div>
</div>
<p>But in this case, we don’t need to work with one word at a time, we need to work with three at a time (a pair of words, and the single word that follows it).
So contrary to the usual practice, an index can be helpful here:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span> <span class="c1"># why -2 ?</span>
   <span class="n">pair</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>
   <span class="n">follower</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Adding a pair to the dict:</strong></p>
<p>For each pair in the text, you need to add it to the dict. But:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">words[i:i</span> <span class="pre">+</span> <span class="pre">2]</span></code> is a list with two words in it. Can that be used as a key in a dict? (try it.) If not, how can you make a valid key out of it?</p></li>
<li><p>As you loop through the text, you will collect pairs of words. Each time, a given pair may already be in the dict.</p>
<ul>
<li><p>If the pair is not in the dict, you want to put it in the dict, with value being a list with the follower in it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s2">&quot;may&quot;</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">):</span> <span class="p">[</span><span class="s2">&quot;wish&quot;</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>If the pair already is in the dict, then you want to add the follower (the second word in the pair) to the list that’s already there:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s2">&quot;wish&quot;</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">):</span> <span class="p">[</span><span class="s2">&quot;may&quot;</span><span class="p">,</span> <span class="s2">&quot;might&quot;</span><span class="p">]</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
<p>Note that the description above suggests the basic logic; it’s almost pseudo-code. And that logic will work.  But it turns out that this is a common enough operation that python dicts have a method that lets you do that logic in one step? Can you find it?</p>
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html?highlight=dictionary#mapping-types-dict">Python dict Documentation</a></p>
<p>As you develop this code, run the tests each time you think you have made some progress:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pytest test_trigrams.py
</pre></div>
</div>
<p>In that test file, there are two tests of the <cite>trigrams()</cite> function: One that tests that it gets the right word pairs as keys:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_trigrams_pairs</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    test that the build_trigram function creates the right pairs of words</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tris</span> <span class="o">=</span> <span class="n">trigrams</span><span class="o">.</span><span class="n">build_trigram</span><span class="p">(</span><span class="n">IWISH</span><span class="p">)</span>

    <span class="n">pairs</span> <span class="o">=</span> <span class="n">tris</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

    <span class="c1"># using a set here, as the dict_keys object is a set as well</span>
    <span class="c1"># And keys are always unique and hashable</span>
    <span class="c1"># and the order does not matter, so perfect for a set</span>
    <span class="k">assert</span> <span class="n">pairs</span> <span class="o">==</span> <span class="p">{(</span><span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;wish&quot;</span><span class="p">),</span>
                     <span class="p">(</span><span class="s2">&quot;wish&quot;</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">),</span>
                     <span class="p">(</span><span class="s2">&quot;may&quot;</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">),</span>
                     <span class="p">(</span><span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;may&quot;</span><span class="p">),</span>
                     <span class="p">}</span>
</pre></div>
</div>
<p>and one that tests if the following word lists are correct:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_trigrams_following_words</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    test that the following words are correct</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tris</span> <span class="o">=</span> <span class="n">trigrams</span><span class="o">.</span><span class="n">build_trigram</span><span class="p">(</span><span class="n">IWISH</span><span class="p">)</span>

    <span class="c1"># this will only print if the test fails</span>
    <span class="c1"># but if if does, you can see what&#39;s going on to try to fix it.</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">tris</span><span class="p">)</span>

    <span class="c1"># a separate assert for each pair:</span>
    <span class="k">assert</span> <span class="n">tris</span><span class="p">[(</span><span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;wish&quot;</span><span class="p">)]</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">tris</span><span class="p">[(</span><span class="s2">&quot;wish&quot;</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">)]</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;may&quot;</span><span class="p">,</span> <span class="s2">&quot;might&quot;</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">tris</span><span class="p">[(</span><span class="s2">&quot;may&quot;</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">)]</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;wish&quot;</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">tris</span><span class="p">[(</span><span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;may&quot;</span><span class="p">)]</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Note that if the first test fails, almost certainly the second will too (the second test explicitly looks for all the same keys). That’s OK. It’s still good to keep them separate, because the first test could pass while the second one fails – it’s nice to know you’ve made progress!</p>
<p>If it seems like we have hard-coded a lot of detail into the tests – you are right. But this is quite deliberate. And it is why we chose such a simple set of words to start out with. If you want to read a bit more about this approach, this blogger puts it nicely:
<a class="reference external" href="https://amir.rachum.com/blog/2017/01/14/explicit-tests/">Write Explicit Tests</a></p>
<p>If both tests pass, you should now have code that will return a dict like we noted above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{(</span><span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;wish&quot;</span><span class="p">):</span> <span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">],</span>
 <span class="p">(</span><span class="s2">&quot;wish&quot;</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">):</span> <span class="p">[</span><span class="s2">&quot;may&quot;</span><span class="p">,</span> <span class="s2">&quot;might&quot;</span><span class="p">],</span>
 <span class="p">(</span><span class="s2">&quot;may&quot;</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">):</span> <span class="p">[</span><span class="s2">&quot;wish&quot;</span><span class="p">],</span>
 <span class="p">(</span><span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;may&quot;</span><span class="p">):</span> <span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">]}</span>
</pre></div>
</div>
<p>Try it out on a longer bit of text (your choice) before you go any further. If it doesn’t work correctly, make sure to write a test that catches the problem before you fix it!</p>
</section>
<section id="using-the-trigrams-dict">
<h4>Using the Trigrams dict<a class="headerlink" href="#using-the-trigrams-dict" title="Link to this heading"></a></h4>
<p>This is the fun part. Once you have a mapping of word pairs to following words, you can build up some new “fake” text. Re-read the previous sections again to remind yourself of the procedure. Here are a couple of additional hints and questions to consider:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">random</span></code> module: <a class="reference external" href="https://docs.python.org/3/library/random.html#module-random">https://docs.python.org/3/library/random.html#module-random</a> is your friend here:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>

<span class="c1"># returns a number between a and b (including a and b)</span>
<span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="c1"># pick a random item from a sequence</span>
<span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">a_list</span><span class="p">)</span>
</pre></div>
</div>
<p>This is all pretty tricky to test – after all, you are selecting random words – you can’t know what the result should be! There are two tactics you can take to test code with <code class="docutils literal notranslate"><span class="pre">random</span></code> calls in it.</p>
<p>Tactic one is to break you code down into pieces that you <em>can</em> test – everything BUT the random choices.</p>
<p>Tactic two is to set the random seed before each test, to assure the same result.
The built in <code class="docutils literal notranslate"><span class="pre">random</span></code> module <a class="reference external" href="https://docs.python.org/3/library/random.html#random.seed">provides a way to set the seed</a>: the <code class="docutils literal notranslate"><span class="pre">random.seed()</span></code> function.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Computers don’t really make truly random numbers. What they do is compute a sequence of numbers that are statistically very much like random numbers, known as <a class="reference external" href="https://en.wikipedia.org/wiki/Pseudorandom_number_generator">“pseudo random numbers”</a>. If you start with the same initial value, known as the “seed”, then you will get the same sequence of numbers (<a class="reference external" href="https://en.wikipedia.org/wiki/Random_seed">random seed</a>).</p>
</div>
<p>The provided tests use both of these tactics.</p>
<ul class="simple">
<li><p>You need to start with the first word pair; picking a random key from a dict is actually a bit tricky. But we have a test for it:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_pick_random_pair</span><span class="p">():</span>
    <span class="n">test_pairs</span> <span class="o">=</span> <span class="p">{(</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">):</span> <span class="p">[],</span>
                  <span class="p">(</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;three&quot;</span><span class="p">):</span> <span class="p">[],</span>
                  <span class="p">(</span><span class="s2">&quot;four&quot;</span><span class="p">,</span> <span class="s2">&quot;five&quot;</span><span class="p">):</span> <span class="p">[],</span>
                  <span class="p">(</span><span class="s2">&quot;six&quot;</span><span class="p">,</span> <span class="s2">&quot;seven&quot;</span><span class="p">):</span> <span class="p">[],</span>
                  <span class="p">(</span><span class="s2">&quot;eight&quot;</span><span class="p">,</span> <span class="s2">&quot;nine&quot;</span><span class="p">):</span> <span class="p">[],</span>
                  <span class="p">}</span>
    <span class="c1"># set the seed so we&#39;ll always get the same one</span>
    <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>
    <span class="n">pair</span> <span class="o">=</span> <span class="n">trigrams</span><span class="o">.</span><span class="n">pick_random_pair</span><span class="p">(</span><span class="n">test_pairs</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;the pair is:&quot;</span><span class="p">,</span> <span class="n">pair</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">pair</span> <span class="o">==</span> <span class="p">(</span><span class="s1">&#39;six&#39;</span><span class="p">,</span> <span class="s1">&#39;seven&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>So you’ll need to define a function: <code class="docutils literal notranslate"><span class="pre">pick_random_pair()</span></code> that takes your trigram dict as input, and returns a random key.</p>
<p>Note that the particular result in the test is using a particular algorithm – if you use a different one, you might get a different pair – but since the seed is set, you should get the same one every time the test is run, so you can make the test check for the one your code returns.</p>
<p>Once you’ve got the first starting pair, you’ll need to make your text,
so you’ll need a data structure to build it up in.  You probably want to build it up in a list, appending one word at a time.  You can join it together at the end with <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">&quot;.join(the_list_of_words)</span></code>, which will make a string, separating the words with a space.</p>
<p>Remember that after adding a word to a pair to make a three-word text, the next pair is the last two words in that three-word text.</p>
<p>Here is a test for that step:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_get_last_pair</span><span class="p">():</span>
    <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;this&quot;</span><span class="p">,</span> <span class="s2">&quot;that&quot;</span><span class="p">,</span> <span class="s2">&quot;the&quot;</span><span class="p">,</span> <span class="s2">&quot;other&quot;</span><span class="p">]</span>

    <span class="k">assert</span> <span class="n">trigrams</span><span class="o">.</span><span class="n">get_last_pair</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="s2">&quot;the&quot;</span><span class="p">,</span> <span class="s2">&quot;other&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>write a function: <code class="docutils literal notranslate"><span class="pre">get_last_pair()</span></code> that takes a list of words, and returns the last two words as a tuple.</p>
<p>Then you’ll need to pick a random word from the “followers” – the words that followed that pair of words in the original text. There is a test for that, too:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_get_random_follower</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    test getting a random word from the trigrams dict</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># we only need one entry for this test</span>
    <span class="n">tri_dict</span> <span class="o">=</span> <span class="p">{(</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">):</span> <span class="p">[</span><span class="s2">&quot;four&quot;</span><span class="p">,</span> <span class="s2">&quot;five&quot;</span><span class="p">,</span> <span class="s2">&quot;six&quot;</span><span class="p">,</span> <span class="s2">&quot;seven&quot;</span><span class="p">]}</span>

    <span class="c1"># set the seed so the answer will be consistent</span>
    <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>
    <span class="n">word</span> <span class="o">=</span> <span class="n">trigrams</span><span class="o">.</span><span class="n">get_random_follower</span><span class="p">(</span><span class="n">tri_dict</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;got word:&quot;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">word</span> <span class="o">==</span> <span class="s2">&quot;seven&quot;</span>
</pre></div>
</div>
<p>Again, this sets the random seed so that you will always get the same answer. If your code returns a different word – change the test to match.</p>
<p>But what if the word pair is not in the dict? It’s not that likely in a long text, but it can happen. So make sure that your code handles that situation by making sure it passes this test:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_get_random_follower_not_there</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    test what happens when the word pair is not there</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># we only need one entry for this test</span>
    <span class="n">tri_dict</span> <span class="o">=</span> <span class="p">{(</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">):</span> <span class="p">[</span><span class="s2">&quot;four&quot;</span><span class="p">,</span> <span class="s2">&quot;five&quot;</span><span class="p">,</span> <span class="s2">&quot;six&quot;</span><span class="p">,</span> <span class="s2">&quot;seven&quot;</span><span class="p">]}</span>

    <span class="c1"># here&#39;s a word pair that isn&#39;t there</span>
    <span class="c1"># make sure you get something back!</span>
    <span class="n">word</span> <span class="o">=</span> <span class="n">trigrams</span><span class="o">.</span><span class="n">get_random_follower</span><span class="p">(</span><span class="n">tri_dict</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;one&quot;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;got word:&quot;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">word</span>  <span class="c1"># this asserts that you got a non-empty string</span>
</pre></div>
</div>
<p>Note that there are a number of options here as to what to do – but make sure it returns <em>something</em>.</p>
</section>
<section id="putting-it-together">
<h4>Putting it Together<a class="headerlink" href="#putting-it-together" title="Link to this heading"></a></h4>
<p>You now have the pieces you need to make some new text. Let’s write a function that will make a single sentence a specified number of words long. The first word should be capitalized, and it should end with a period. Here is the test for that function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_make_sentence</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    test making a trigrams sentence</span>

<span class="sd">    as it is supposed to be random, this tests for things other than</span>
<span class="sd">    the actual results.</span>

<span class="sd">    NOTE that this test relies on the build_trigram() function, so it</span>
<span class="sd">         will fail if that doesn&#39;t work.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># use the already tested build_trigram function to make the dict</span>
    <span class="n">tri_dict</span> <span class="o">=</span> <span class="n">trigrams</span><span class="o">.</span><span class="n">build_trigram</span><span class="p">(</span><span class="n">LONGER_TEXT</span><span class="p">)</span>


    <span class="c1"># make a sentence of 6 words</span>
    <span class="n">sentence</span> <span class="o">=</span> <span class="n">trigrams</span><span class="o">.</span><span class="n">make_sentence</span><span class="p">(</span><span class="n">tri_dict</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
    <span class="c1"># check that it has 6 words</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">sentence</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">==</span> <span class="mi">6</span>
    <span class="c1"># check that the first letter is a capital</span>
    <span class="k">assert</span> <span class="n">sentence</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">sentence</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="c1"># check that it ends with a period</span>
    <span class="k">assert</span> <span class="n">sentence</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span>
    <span class="c1"># check that there is not a space between the period and the last word.</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="n">sentence</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">isspace</span><span class="p">()</span>
</pre></div>
</div>
<p>Notice that this test did not set the random seed. Rather, it checked for various properties of the results, without checking for specific words. This is a helpful tactic – have your tests check for what is important about the results, not necessarily the specific results.</p>
<p>You can now use the previous functions to make a <code class="docutils literal notranslate"><span class="pre">make_sentence()</span></code> function that passes these tests.</p>
<p>Once you have the basics working, try your code on a longer piece of input text. Then think about making it fancy: put a number of sentences of random length to form a paragraph? Add in some other random punctuation? Anything else to make the text more “real”?</p>
</section>
</section>
<section id="processing-the-input-text">
<h3>Processing the Input Text<a class="headerlink" href="#processing-the-input-text" title="Link to this heading"></a></h3>
<p>If you get a book from Project Gutenberg (or anywhere else), it will not be “clean.” That is, it will have header information, footer information, chapter headings, punctuation, what have you. So you’ll need to clean it up somehow to get a simple list of words to use to build your trigrams.</p>
<p>The first part of the process is pretty straightforward; open the file and loop through the lines of text and process them.</p>
<p>You may want to skip the header. How would you do that??</p>
<p>Hint: in a Project Gutenberg e-book, there is a line of text that starts with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">***</span> <span class="n">START</span> <span class="n">OF</span> <span class="n">THIS</span> <span class="n">PROJECT</span> <span class="n">GUTENBERG</span> <span class="n">EBOOK</span>
</pre></div>
</div>
<p>In the loop, you can process a single line of text to break it into words by calling <code class="docutils literal notranslate"><span class="pre">.split()</span></code>.</p>
<p>Optional steps to cleaning up the text:</p>
<blockquote>
<div><ul class="simple">
<li><p>Strip out punctuation?
- If you do this, what about contractions, i.e. the apostrophe in “can’t” vs. a single quotation mark – which are the same character.</p></li>
<li><p>Remove capitalization?
- If you do this, what about “I”? And proper nouns?</p></li>
</ul>
</div></blockquote>
<p>Any other ideas you may have.</p>
<p>Be sure to use TDD as you develop the “clean up” code: write a test for one feature, and then make sure your code passes that test.</p>
<p>Lather, rinse and repeat.</p>
<p>There are a number of tests for cleaning up the code commented out in the test file. Feel free to use these as a starting point.</p>
<p><strong>Hints:</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">string</span></code> methods are your friend here.</p>
<p>There are also handy constants in the <code class="docutils literal notranslate"><span class="pre">string</span></code> module: <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">string</span></code>
(<a class="reference external" href="https://docs.python.org/3/library/string.html">https://docs.python.org/3/library/string.html</a>)</p>
<p>Check out the <code class="docutils literal notranslate"><span class="pre">str.translate()</span></code> method; it can make multiple replacements very fast.</p>
<p>Do get the full trigrams code working first, then play with some of the fancier options.</p>
</section>
<section id="code-structure">
<h3>Code Structure<a class="headerlink" href="#code-structure" title="Link to this heading"></a></h3>
<p>You will have found that following TDD forces you to break your code down into a handful of separate functions, each of which does only one thing. This lets you test each function on its own, and it’s easier to refactor one part without messing with the others. Then you can put them all together into a simple program.</p>
<p>For instance, your <code class="docutils literal notranslate"><span class="pre">__main__</span></code> block might look something like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># get the filename from the command line</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;You must pass in a filename&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">in_data</span> <span class="o">=</span> <span class="n">read_in_data</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">make_words</span><span class="p">(</span><span class="n">in_data</span><span class="p">)</span>
    <span class="n">word_pairs</span> <span class="o">=</span> <span class="n">build_trigram</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
    <span class="n">new_text</span> <span class="o">=</span> <span class="n">build_text</span><span class="p">(</span><span class="n">word_pairs</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">new_text</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Have Fun!</strong></p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../mailroom/mailroom_with_files.html" class="btn btn-neutral float-left" title="Mailroom With Files" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../topics/10-modules_packages/index.html" class="btn btn-neutral float-right" title="10. Modules and Packages" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Natasha Aleksandrova, Christopher Barker, Brian Dorsey, Cris Ewing, Christy Heaton, Jon Jacky, Maria McKinley, Andy Miles, Rick Riehle, Joseph Schilz, Joseph Sheedy, Hosung Song. Creative Commons Attribution-ShareAlike 4.0 license.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>