

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Iterators and Generators &mdash; Programming in Python 8.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=bb3927b2"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Decorators" href="Decorators.html" />
    <link rel="prev" title="Unicode in Python" href="Unicode.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #4b2e83" >

          
          
          <a href="../index.html">
            
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Topics in the Program</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../topics/01-setting_up/index.html">1. Setting up your Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/02-basic_python/index.html">2. Basic Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/03-recursion_booleans/index.html">3. Booleans and Recursion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/04-sequences_iteration/index.html">4. Sequences and Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/05-text_handling/index.html">5. Basic Text Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/06-exceptions/index.html">6. Exception Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/07-unit_testing/index.html">7. Unit Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/08-dicts_sets/index.html">8. Dictionaries and Sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/09-files/index.html">9. File Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/10-modules_packages/index.html">10. Modules and Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/11-argument_passing/index.html">11. Advanced Argument Passing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/12-comprehensions/index.html">12. Comprehensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/13-intro_oo/index.html">13. Intro to Object Oriented Programing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/14-magic_methods/index.html">14. Properties and Magic Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/15-subclassing/index.html">15. Subclassing and Inheritance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/16-multiple_inheritance/index.html">16. Multiple Inheritance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/17-functional_programming/index.html">17. Introduction to Functional Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/18-advanced_testing/index.html">18. Advanced Testing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../topics/99-extras/index.html">19. Extra Topics</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Pep8.html">Coding Style and Linting</a></li>
<li class="toctree-l2"><a class="reference internal" href="CodeReviews.html">Code Reviews</a></li>
<li class="toctree-l2"><a class="reference internal" href="PersistanceAndSerialization.html">Persistence and Serialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="Unicode.html">Unicode in Python</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Iterators and Generators</a></li>
<li class="toctree-l2"><a class="reference internal" href="Decorators.html">Decorators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exercises/mailroom/mailroom-decorator.html">Mailroom – Decoratoring it</a></li>
<li class="toctree-l2"><a class="reference internal" href="ContextManagers.html">Context Managers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exercises/context-managers-exercise.html">A Couple Handy Context Managers</a></li>
<li class="toctree-l2"><a class="reference internal" href="MetaProgramming.html">Metaprogramming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exercises/mailroom/mailroom-meta.html">Mailroom – metaprogramming it!</a></li>
<li class="toctree-l2"><a class="reference internal" href="Logging.html">Logging and the logging module</a></li>
<li class="toctree-l2"><a class="reference internal" href="Debugging.html">Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="NoSQL.html">No SQL Databases</a></li>
<li class="toctree-l2"><a class="reference internal" href="GraphDatabases.html">Graph Databases</a></li>
<li class="toctree-l2"><a class="reference internal" href="Concurrency.html">Concurrent Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="Async.html">Asychronous Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="Coroutines.html">Notes on Coroutines</a></li>
<li class="toctree-l2"><a class="reference internal" href="ThreadingMultiprocessing.html">Threading and multiprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exercises/threaded_downloader.html">Threaded Web Scraper</a></li>
<li class="toctree-l2"><a class="reference internal" href="Profiling.html">Performance and Profiling</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #4b2e83" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Programming in Python</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../topics/99-extras/index.html"><span class="section-number">19. </span>Extra Topics</a></li>
      <li class="breadcrumb-item active">Iterators and Generators</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/modules/IteratorsAndGenerators.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="Unicode.html" class="btn btn-neutral float-left" title="Unicode in Python" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Decorators.html" class="btn btn-neutral float-right" title="Decorators" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="iterators-and-generators">
<span id="iterators-generators"></span><h1>Iterators and Generators<a class="headerlink" href="#iterators-and-generators" title="Link to this heading"></a></h1>
<blockquote>
<div><p>The Tools of Pythonicity</p>
<blockquote>
<div><p>What goes on in those for loops?</p>
</div></blockquote>
</div></blockquote>
<section id="a-note-about-python-history">
<h2>A note about Python History<a class="headerlink" href="#a-note-about-python-history" title="Link to this heading"></a></h2>
<section id="python-2">
<h3>Python 2<a class="headerlink" href="#python-2" title="Link to this heading"></a></h3>
<p>Python used to be all about sequences – a good chunk of anything you did
was stored in a sequence, or involved manipulating a sequence.</p>
<ul class="simple">
<li><p>lists</p></li>
<li><p>tuples</p></li>
<li><p>strings</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dict.keys()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dict.values()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dict.items()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">zip()</span></code></p></li>
<li><p>…</p></li>
</ul>
<p>In python2 – those are all sequences. (in the case of zip and dict methods, they return actual lists)</p>
<p>But it turns out that the most common operation for sequences is to iterate through them:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">a_sequence</span><span class="p">:</span>
    <span class="n">do_something_with_item</span>
</pre></div>
</div>
<p>So fairly early in Python2, Python introduced the idea of the “iterable”.</p>
<p>More or less, an “iterable” is something you can, well, iterate over in
a for loop, but often does not keep the whole sequence in memory at once.</p>
<p>After all – why make a copy of something just to look at all its items?</p>
<p>Example:</p>
<p>In python2: <code class="docutils literal notranslate"><span class="pre">dict.keys()</span></code> returns a list of all the keys in the dict.
But why make a full copy of all the keys, when all you want to do is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">do_something_with</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
<p>Even worse: <code class="docutils literal notranslate"><span class="pre">dict.items()</span></code> created a full list of <code class="docutils literal notranslate"><span class="pre">(key,</span> <span class="pre">value)</span></code> tuples.
– a complete copy of all the data in the dict.</p>
<p>Even worse still: <code class="docutils literal notranslate"><span class="pre">enumerate(dict.items())</span></code> created a whole list of
<code class="docutils literal notranslate"><span class="pre">(index,</span> <span class="pre">(key,</span> <span class="pre">value))</span></code> tuples – lots of copies of everything.</p>
<p>Enter <code class="docutils literal notranslate"><span class="pre">iter*</span></code></p>
<p>Python2 then introduced “iterable” versions of a number of functions and methods:</p>
<p><code class="docutils literal notranslate"><span class="pre">itertools.izip</span></code>
<code class="docutils literal notranslate"><span class="pre">dict.iteritems()</span></code>
<code class="docutils literal notranslate"><span class="pre">dict.iterkeys()</span></code>
<code class="docutils literal notranslate"><span class="pre">dict.itervalues()</span></code></p>
<p>So you could now iterate through that stuff without copying anything. Nice performance benefits, but a somewhat ugly interface.</p>
</section>
<section id="python3">
<h3>Python3<a class="headerlink" href="#python3" title="Link to this heading"></a></h3>
<p>Python3 embraces iterables – now everything that could be an iterable without making a copy is done that way – no unnecessary copies.</p>
<p>If you DO need an actual sequence (becasue you want to do something with it other than iterate over it), you have to make a list out of them explicitly:</p>
<p><code class="docutils literal notranslate"><span class="pre">list(dict.keys())</span></code></p>
<p>Then there is an entire module: <code class="docutils literal notranslate"><span class="pre">itertools</span></code> that provides nifty ways
to iterate through stuff.</p>
<p>That will be covered elsewhere.</p>
<p>So while I used to say that python was “all about sequences”, I know say:</p>
<blockquote>
<div><p>“Python is all about iterables</p>
</div></blockquote>
</section>
</section>
<section id="iterators-and-iterables">
<h2>Iterators and Iterables<a class="headerlink" href="#iterators-and-iterables" title="Link to this heading"></a></h2>
<p>Iteration is one of the main reasons Python code is so readable:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">just_about_anything</span><span class="p">:</span>
    <span class="n">do_stuff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>An “iterable” is anything that can be looped over sequentially, so it does not have to be
a “sequence”: list, tuple, etc.  For example, a string is iterable. So is a set.</p>
<p>An iterator is an iterable that remembers state. All sequences are iterable, but
not all sequences are iterators. To make a sequence an iterator, you can call it with iter:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_iter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">my_sequence</span><span class="p">)</span>
</pre></div>
</div>
<p>Iterator Types:</p>
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#iterator-types">https://docs.python.org/3/library/stdtypes.html#iterator-types</a></p>
</section>
<section id="iterables">
<h2>Iterables<a class="headerlink" href="#iterables" title="Link to this heading"></a></h2>
<p>To make an object iterable, you simply have to implement the <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">T</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">position</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span>
        <span class="k">return</span> <span class="n">position</span>
</pre></div>
</div>
</section>
<section id="iter">
<h2><code class="docutils literal notranslate"><span class="pre">iter()</span></code><a class="headerlink" href="#iter" title="Link to this heading"></a></h2>
<p>How do you get the iterator object from an “iterable”?</p>
<p>The <code class="docutils literal notranslate"><span class="pre">iter</span></code> function will make any iterable an iterator. It first looks for the <code class="docutils literal notranslate"><span class="pre">__iter__</span></code>
method, and if none is found, uses <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> to create the iterator.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">iter()</span></code> function:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [20]: </span><span class="nb">iter</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gh">Out[20]: </span><span class="go">&lt;listiterator at 0x101e01350&gt;</span>

<span class="gp">In [21]: </span><span class="nb">iter</span><span class="p">(</span><span class="s2">&quot;a string&quot;</span><span class="p">)</span>
<span class="gh">Out[21]: </span><span class="go">&lt;iterator at 0x101e01090&gt;</span>

<span class="gp">In [22]: </span><span class="nb">iter</span><span class="p">(</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;tuple&#39;</span><span class="p">)</span> <span class="p">)</span>
<span class="gh">Out[22]: </span><span class="go">&lt;tupleiterator at 0x101e01710&gt;</span>
</pre></div>
</div>
</section>
<section id="list-as-an-iterator">
<h2>List as an Iterator:<a class="headerlink" href="#list-as-an-iterator" title="Link to this heading"></a></h2>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [10]: </span><span class="n">a_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>

<span class="gp">In [11]: </span><span class="n">list_iter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">a_list</span><span class="p">)</span>

<span class="gp">In [12]: </span><span class="nb">next</span><span class="p">(</span><span class="n">list_iter</span><span class="p">)</span>
<span class="gh">Out[12]: </span><span class="go">1</span>

<span class="gp">In [13]: </span><span class="nb">next</span><span class="p">(</span><span class="n">list_iter</span><span class="p">)</span>
<span class="gh">Out[13]: </span><span class="go">2</span>

<span class="gp">In [14]: </span><span class="nb">next</span><span class="p">(</span><span class="n">list_iter</span><span class="p">)</span>
<span class="gh">Out[14]: </span><span class="go">3</span>

<span class="gp">In [15]: </span><span class="nb">next</span><span class="p">(</span><span class="n">list_iter</span><span class="p">)</span>
<span class="gt">--------------------------------------------------</span>
<span class="ne">StopIteration</span><span class="g g-Whitespace">     </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-15-1a7db9b70878&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="nb">next</span><span class="p">(</span><span class="n">list_iter</span><span class="p">)</span>
<span class="ne">StopIteration</span>:
</pre></div>
</div>
</section>
<section id="using-iterators-when-you-can">
<h2>Using iterators when you can<a class="headerlink" href="#using-iterators-when-you-can" title="Link to this heading"></a></h2>
<p>consider the example from the trigrams problem:</p>
<p>(<a class="reference external" href="http://codekata.com/kata/kata14-tom-swift-under-the-milkwood/">http://codekata.com/kata/kata14-tom-swift-under-the-milkwood/</a>)</p>
<p>You have a list of words: <code class="docutils literal notranslate"><span class="pre">words</span></code></p>
<p>And you want to go through it, three at a time, and match up pairs with
the following word.</p>
<p>The <em>non-pythonic</em> way to do that is a loop through the indices:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
   <span class="n">triple</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<p>It works, and is fairly efficient, but what about:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">triple</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">words</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">:]):</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">zip()</span></code> returns an iterable – it does not build up the whole list.
So this is quite efficient.</p>
<p>but we are still slicing: ([1:]), which produces a copy – so we are creating three copies of
the list – not so good if memory is tight. Note that they are shallow copies, so not <strong>that</strong> bad.</p>
<p>Nevertheless, we can do better:</p>
<p>The <code class="docutils literal notranslate"><span class="pre">itertools</span></code> module has an <code class="docutils literal notranslate"><span class="pre">islice()</span></code> (iterable slice) function.
It returns an iterator over a slice of a sequence – so no more copies:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go">from itertools import islice</span>

<span class="gp">In [68]: </span><span class="n">triplets</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">islice</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">islice</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

<span class="gp">In [69]: </span><span class="k">for</span> <span class="n">triplet</span> <span class="ow">in</span> <span class="n">triplets</span><span class="p">:</span>
<span class="go">    ...:     print(triplet)</span>
<span class="go">    ...:</span>
<span class="go">(&#39;this&#39;, &#39;that&#39;, &#39;the&#39;)</span>
<span class="go">(&#39;that&#39;, &#39;the&#39;, &#39;other&#39;)</span>
<span class="go">(&#39;the&#39;, &#39;other&#39;, &#39;and&#39;)</span>
<span class="go">(&#39;other&#39;, &#39;and&#39;, &#39;one&#39;)</span>
<span class="go">(&#39;and&#39;, &#39;one&#39;, &#39;more&#39;)</span>
</pre></div>
</div>
</section>
<section id="the-iterator-protocol">
<h2>The Iterator Protocol<a class="headerlink" href="#the-iterator-protocol" title="Link to this heading"></a></h2>
<p>The main thing that differentiates an iterator from an iterable (sequence)
is that an iterator saves state.</p>
<p>An iterable must have the following methods:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">an_iterator</span><span class="o">.</span><span class="fm">__iter__</span><span class="p">()</span>
</pre></div>
</div>
<p>Usually returns the iterator object itself.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">an_iterator</span><span class="o">.</span><span class="fm">__next__</span><span class="p">()</span>
</pre></div>
</div>
<p>Returns the next item from the container. If there are no further items,
raises the <code class="docutils literal notranslate"><span class="pre">StopIteration</span></code> exception.</p>
<p>An <em>iterable</em>, on the other hand, must have a <code class="docutils literal notranslate"><span class="pre">__iter__</span></code> method that returns an initialized iterator (which may or may not be itself). It doesnot have a <code class="docutils literal notranslate"><span class="pre">__next__</span></code> method. So you oculd say that the difference between and iterator and a iterable, is htat iterables do not have <code class="docutils literal notranslate"><span class="pre">__next__</span></code> methods: you cannont call <code class="docutils literal notranslate"><span class="pre">next()</span></code> on them.</p>
</section>
<section id="making-an-iterator">
<h2>Making an Iterator<a class="headerlink" href="#making-an-iterator" title="Link to this heading"></a></h2>
<p>A simple version of <code class="docutils literal notranslate"><span class="pre">range()</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">IterateMe_1</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="n">stop</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">current</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span>
</pre></div>
</div>
</section>
<section id="what-does-for-do">
<h2>What does <code class="docutils literal notranslate"><span class="pre">for</span></code> do?<a class="headerlink" href="#what-does-for-do" title="Link to this heading"></a></h2>
<p>Now that we know the iterator protocol, we can write something like a for loop:</p>
<p><a class="reference download internal" download="" href="../_downloads/6f19c1a8554518241fa56859fad09ec8/my_for.py"><code class="xref download docutils literal notranslate"><span class="pre">my_for.py</span></code></a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">my_for</span><span class="p">(</span><span class="n">an_iterable</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Emulation of a for loop.</span>

<span class="sd">    func() will be called with each item in an_iterable</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># equiv of &quot;for i in l:&quot;</span>
    <span class="n">iterator</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">an_iterable</span><span class="p">)</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">func</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="itertools">
<h2>Itertools<a class="headerlink" href="#itertools" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">itertools</span></code>  is a collection of utilities that make it easy to
build an iterator that iterates over sequences in various common ways</p>
<p><a class="reference external" href="http://docs.python.org/3/library/itertools.html">http://docs.python.org/3/library/itertools.html</a></p>
<p><a class="reference external" href="https://pymotw.com/3/itertools/index.html">https://pymotw.com/3/itertools/index.html</a></p>
<p>NOTE:</p>
<p>iteratables are not <em>only</em> for <code class="docutils literal notranslate"><span class="pre">for</span></code></p>
<p>They can be used with anything that expects an iterable:</p>
<p><code class="docutils literal notranslate"><span class="pre">sum</span></code>, <code class="docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="docutils literal notranslate"><span class="pre">sorted</span></code>, <code class="docutils literal notranslate"><span class="pre">list</span></code>, …</p>
</section>
<section id="is-an-iterator-a-type">
<h2>Is an iterator a type?<a class="headerlink" href="#is-an-iterator-a-type" title="Link to this heading"></a></h2>
<p>Iterators are not a type. An “iterable” is anything that has an <code class="docutils literal notranslate"><span class="pre">__iter__</span></code>
method that returns an iterator and/or has a <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> method that takes 0-based indexes.</p>
<p>An “iterator” is anything that conforms to the “iterator protocol”:</p>
<blockquote>
<div><ul class="simple">
<li><p>Has a <code class="docutils literal notranslate"><span class="pre">__next__()</span></code> method that returns objects.</p></li>
<li><p>Raises <code class="docutils literal notranslate"><span class="pre">StopIteration</span></code> when their are no more objects to be returned.</p></li>
<li><p>Has a <code class="docutils literal notranslate"><span class="pre">__iter__()</span></code> method that returns an iterator – usually itself.
- sometimes the <code class="docutils literal notranslate"><span class="pre">__iter__()</span></code> method re-sets the iteration…</p></li>
</ul>
</div></blockquote>
<p><a class="reference external" href="https://docs.python.org/3/glossary.html#term-iterator">https://docs.python.org/3/glossary.html#term-iterator</a></p>
<p>Lots of common iterators are different types:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [23]: </span><span class="nb">type</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<span class="gh">Out[23]: </span><span class="go">range_iterator</span>

<span class="gp">In [24]: </span><span class="nb">iter</span><span class="p">(</span><span class="nb">list</span><span class="p">())</span>
<span class="gh">Out[24]: </span><span class="go">&lt;list_iterator at 0x104437fd0&gt;</span>

<span class="gp">In [27]: </span><span class="nb">type</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="nb">zip</span><span class="p">([],[])))</span>
<span class="gh">Out[27]: </span><span class="go">zip</span>
</pre></div>
</div>
<p>Here’s a nice overview:</p>
<p><a class="reference external" href="http://treyhunner.com/2016/12/python-iterator-protocol-how-for-loops-work/">http://treyhunner.com/2016/12/python-iterator-protocol-how-for-loops-work/</a></p>
</section>
<section id="lab">
<h2>LAB<a class="headerlink" href="#lab" title="Link to this heading"></a></h2>
<p><a class="reference download internal" download="" href="../_downloads/856962444f5328c5d5739a3d7d67384e/iterator_1.py"><code class="xref download docutils literal notranslate"><span class="pre">iterator_1.py</span></code></a></p>
<ul class="simple">
<li><p>Extend (<code class="docutils literal notranslate"><span class="pre">iterator_1.py</span></code> ) to be more like <code class="docutils literal notranslate"><span class="pre">range()</span></code> – add three input parameters: <code class="docutils literal notranslate"><span class="pre">iterator_2(start,</span> <span class="pre">stop,</span> <span class="pre">step=1)</span></code></p></li>
<li><p>What happens if you break from a loop and try to pick it up again:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="o">=</span> <span class="n">IterateMe_2</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>  <span class="k">break</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Does <code class="docutils literal notranslate"><span class="pre">range()</span></code>  behave the same?</p>
<ul>
<li><p>make yours match <code class="docutils literal notranslate"><span class="pre">range()</span></code></p></li>
<li><p>is range an iterator or an iteratable?</p></li>
</ul>
</li>
</ul>
</section>
<section id="generators">
<h2>Generators<a class="headerlink" href="#generators" title="Link to this heading"></a></h2>
<p>Generators</p>
<ul class="simple">
<li><p>give you an iterator object</p></li>
<li><p>no access to the underlying data … if it even exists</p></li>
</ul>
<dl>
<dt>Conceptually:</dt><dd><p>Iterators are about various ways to loop over data.</p>
<p>Generators can generate the data on the fly.</p>
</dd>
<dt>Practically:</dt><dd><p>You can use either one either way (and a generator is one type of iterator).</p>
<p>Generators do some of the book-keeping for you – simpler syntax.</p>
<p>Generators also can be used for times you want to pause a function
and pick it back up later where you left off.</p>
</dd>
</dl>
</section>
<section id="yield">
<h2>yield<a class="headerlink" href="#yield" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">yield</span></code>  is a way to make a quickie generator with a function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">a_generator_function</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">some_stuff</span>
    <span class="k">yield</span> <span class="n">something</span>
</pre></div>
</div>
<p>Generator functions “yield” a value, rather than returning a value.</p>
<p>It <em>does</em> ‘return’ a value, but rather than ending execution of the
function – it preserves the state so it can pick up where it left off.</p>
<p>State is preserved in between yields.</p>
<p>A function with <code class="docutils literal notranslate"><span class="pre">yield</span></code>  in it is a “factory” for a generator</p>
<p>Each time you call it, you get a new generator:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gen_a</span> <span class="o">=</span> <span class="n">a_generator</span><span class="p">()</span>
<span class="n">gen_b</span> <span class="o">=</span> <span class="n">a_generator</span><span class="p">()</span>
</pre></div>
</div>
<p>Each instance keeps its own state.</p>
<p>Really just a shorthand for an iterator class that does the book keeping for you.</p>
<p>To master yield, you must understand that when you call the function,
the code you have written in the function body does not run. The function
only returns the generator object. The actual code in the function is run
when <code class="docutils literal notranslate"><span class="pre">next()</span></code> is called on the generator itself.</p>
<p>And note that each time you call the “generator function” you get a new
instance of a generator object that saves state separately from other instances.</p>
<p>An example: like <code class="docutils literal notranslate"><span class="pre">range()</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">y_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">start</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">stop</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">i</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="n">step</span>
</pre></div>
</div>
<p>Real World Example from FloatCanvas:</p>
<p><a class="reference external" href="https://github.com/svn2github/wxPython/blob/master/3rdParty/FloatCanvas/floatcanvas/FloatCanvas.py#L100">https://github.com/svn2github/wxPython/blob/master/3rdParty/FloatCanvas/floatcanvas/FloatCanvas.py#L100</a></p>
<p>Note:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [164]: </span><span class="n">gen</span> <span class="o">=</span> <span class="n">y_range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">In [165]: </span><span class="nb">type</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
<span class="gh">Out[165]: </span><span class="go">generator</span>
<span class="gp">In [166]: </span><span class="nb">dir</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
<span class="gh">Out[166]:</span>
<span class="go">...</span>
<span class="go"> &#39;__iter__&#39;,</span>
<span class="go">...</span>
<span class="go"> &#39;__next__&#39;,</span>
</pre></div>
</div>
<p>So the generator <strong>is</strong> an iterator</p>
<p>Note: A generator function can also be a method in a class</p>
<p>In fact, this is a nice way to provide different ways to iterate over
the data in a class in multiple ways.</p>
<p>This is done by the dict protocol with <code class="docutils literal notranslate"><span class="pre">dict.keys()</span></code> and <code class="docutils literal notranslate"><span class="pre">dict.values()</span></code>.</p>
<p>More about iterators and generators:</p>
<p>Chapter 14 in Fluent Python by Luciano Ramalho</p>
<p><a class="reference external" href="http://www.learningpython.com/2009/02/23/iterators-iterables-and-generators-oh-my/">http://www.learningpython.com/2009/02/23/iterators-iterables-and-generators-oh-my/</a></p>
<p><a class="reference download internal" download="" href="../_downloads/429df84ad67b90296d8e26a683f2ae13/yield_example.py"><code class="xref download docutils literal notranslate"><span class="pre">yield_example.py</span></code></a></p>
</section>
<section id="generator-comprehensions">
<h2>generator comprehensions<a class="headerlink" href="#generator-comprehensions" title="Link to this heading"></a></h2>
<p>yet another way to make a generator:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
<span class="go">[2, 4, 6]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">&lt;generator object &lt;genexpr&gt; at 0x10911bf50&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]):</span>
<span class="gp">... </span>  <span class="nb">print</span> <span class="n">n</span>
<span class="gp">... </span><span class="mi">2</span> <span class="mi">4</span> <span class="mi">6</span>
</pre></div>
</div>
<p>More interesting if [1, 2, 3] is also a generator</p>
<p>Note that <cite>map</cite> and <cite>filter</cite> produce iterators.</p>
<p>Keep in mind – if all you need to do with the results is loop over it
– use a generator expression rather than a list comprehension.</p>
</section>
<section id="other-uses-for-yield">
<h2>Other uses for <code class="docutils literal notranslate"><span class="pre">yield</span></code><a class="headerlink" href="#other-uses-for-yield" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">yield</span></code> keyword and generator functions were designed with classic “generators” in mind.</p>
<p>That is – objects that generate values on the fly.</p>
<p>But, as we alluded to earlier, <code class="docutils literal notranslate"><span class="pre">yield</span></code> can be used for other things as well.</p>
<p>Anytime you want to return a value, and then hold state until later,
<code class="docutils literal notranslate"><span class="pre">yield</span></code> can be used.</p>
<p><strong>Example:</strong> pytest fixtures:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">example_fixture</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="c1"># setup code here</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">something</span><span class="p">()</span>
    <span class="k">yield</span> <span class="n">value</span>  <span class="c1"># provide the fixture value</span>
    <span class="c1"># do the teardown</span>
    <span class="n">something_with</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case, the <code class="docutils literal notranslate"><span class="pre">yield</span></code> isn’t in any sort of loop or anything.
It will only get run once. But the generator will maintain state,
so the value can be used after the yield to do the teardown.</p>
<p>How would this be done without yield? You’d need to store the value in a class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">a_fixture</span><span class="p">():</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># make it callable so it can provide the value</span>
        <span class="c1"># setup code here</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">something</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">something_with</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<p>Not horrible, but not as clean and simple.</p>
</section>
<section id="id1">
<h2>LAB<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<p>Write a few generators:</p>
<ul class="simple">
<li><p>Sum of integers</p></li>
<li><p>Doubler</p></li>
<li><p>Fibonacci sequence</p></li>
<li><p>Prime numbers</p></li>
</ul>
<p>Test code in:</p>
<p><a class="reference download internal" download="" href="../_downloads/39ca0e08e448d94dc2220876d643da86/test_generator.py"><code class="xref download docutils literal notranslate"><span class="pre">test_generator.py</span></code></a></p>
<p>Descriptions:</p>
<dl>
<dt>Sum of the integers:</dt><dd><p>keep adding the next integer</p>
<p>0 + 1 + 2 + 3 + 4 + 5 + …</p>
<p>so the sequence is:</p>
<p>0, 1, 3, 6, 10, 15 …..</p>
</dd>
<dt>Doubler:</dt><dd><p>Each value is double the previous value:</p>
<p>1, 2, 4, 8, 16, 32,</p>
</dd>
<dt>Fibonacci sequence:</dt><dd><p>The fibonacci sequence as a generator:</p>
<p>f(n) = f(n-1) + f(n-2)</p>
<p>1, 1, 2, 3, 5, 8, 13, 21, 34…</p>
</dd>
<dt>Prime numbers:</dt><dd><p>Generate the prime numbers (numbers only divisible by them self and 1):</p>
<p>2, 3, 5, 7, 11, 13, 17, 19, 23…</p>
</dd>
<dt>Others to try:</dt><dd><p>Try x^2, x^3, counting by threes, x^e, counting by minus seven, …</p>
</dd>
</dl>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Unicode.html" class="btn btn-neutral float-left" title="Unicode in Python" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Decorators.html" class="btn btn-neutral float-right" title="Decorators" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Natasha Aleksandrova, Christopher Barker, Brian Dorsey, Cris Ewing, Christy Heaton, Jon Jacky, Maria McKinley, Andy Miles, Rick Riehle, Joseph Schilz, Joseph Sheedy, Hosung Song. Creative Commons Attribution-ShareAlike 4.0 license.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>